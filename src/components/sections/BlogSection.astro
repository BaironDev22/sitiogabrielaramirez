---
import { getCollection } from 'astro:content';
import BlogCard from '../ui/BlogCard.astro';
import Button from '../ui/Button.astro';

// Obtener los últimos 3 artículos del blog, ordenados por fecha
const allBlogPosts = await getCollection('blog');
const latestPosts = allBlogPosts
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<section class="relative py-24 px-6 md:px-12 lg:px-20 bg-secondary/5" id="blog">
  <div class="max-w-7xl mx-auto">
    
    <!-- Encabezado -->
    <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-8 mb-16">
      <div>
        <span class="inline-block text-xs font-medium tracking-widest uppercase text-coral-500 mb-3">
          EL BLOG
        </span>
        <h2 class="font-italianno text-6xl md:text-7xl text-dark">
          Sexoguía
        </h2>
      </div>
      
      <Button variant="outline" size="md" href="/blog" class="group">
        Ver todos los artículos
        <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </Button>
    </div>

    <!-- Grid de artículos -->
    {latestPosts.length > 0 ? (
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-10 lg:gap-12">
        {latestPosts.map((post) => (
          <BlogCard
            title={post.data.title}
            description={post.data.description}
            category={post.data.category}
            image={post.data.image}
            slug={post.slug}
          />
        ))}
      </div>
    ) : (
      <div class="text-center py-20">
        <p class="text-dark/60 text-lg">Próximamente nuevos artículos...</p>
      </div>
    )}
  </div>
</section>
